services:
    web:
        image: ivanyosifov/bgapp-web
        deploy:
            replicas: 3
        ports:
            - 8080:80
        volumes:
            - "/home/vagrant/devops_docker_demo/web:/var/www/html:ro"
            - "/home/vagrant/devops_docker_demo/token:~/token:"
        networks:
            - app-network
    db:
        image: ivanyosifov/bgapp-db
        networks:
            - app-network
        environment:
            MYSQL_ROOT_PASSWORD_FILE: /run/secrets/db_root_password
        secrets:
           - db_root_password
secrets:
    db_root_password:
        external: true
networks:
    app-network:
